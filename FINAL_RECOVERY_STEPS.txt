# ğŸš¨ æœ€åçš„æ¢å¤æ­¥éª¤ - æŒ‰é¡ºåºæ‰§è¡Œ

ä½ è¯´"åˆå¡ä½äº†"ï¼Œè¿™ä»½æ–‡ä»¶åŒ…å«äº†æˆ‘èƒ½æƒ³åˆ°çš„æ‰€æœ‰å¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚

---

## âš¡ å¿«é€Ÿä¿®å¤ï¼ˆ3åˆ†é’Ÿï¼‰

### ç¬¬0æ­¥ï¼šæ€æ­»æ‰€æœ‰è¿›ç¨‹
```
# Mac: ç”¨Activity Monitoræ€æ­»æ‰€æœ‰pythonè¿›ç¨‹
# æˆ–åœ¨Terminalè¿è¡Œ:
killall python3 python
sleep 2
```

### ç¬¬1æ­¥ï¼šå¯åŠ¨åç«¯
```bash
cd /Users/ck/Desktop/Project/trustagency/backend
python -m uvicorn app.main:app --reload --port 8000 2>&1
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š
```
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### ç¬¬2æ­¥ï¼šæ‰“å¼€æµè§ˆå™¨æµ‹è¯•
```
http://localhost:8000/admin/
```

### ç¬¬3æ­¥ï¼šå¦‚æœåå°æ— æ³•åŠ è½½

åœ¨å¦ä¸€ä¸ªTerminalçª—å£è¿è¡Œæ¢å¤è„šæœ¬ï¼š
```bash
cd /Users/ck/Desktop/Project/trustagency/backend
python restore_categories.py
```

---

## âŒ å¦‚æœç¬¬1æ­¥å¤±è´¥äº†

### é”™è¯¯1ï¼šModuleNotFoundError: No module named 'fastapi'

**è§£å†³**ï¼š
```bash
cd /Users/ck/Desktop/Project/trustagency/backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æˆ–ç›´æ¥å®‰è£…å…³é”®åŒ…
pip install fastapi uvicorn sqlalchemy python-dotenv pydantic pydantic-settings
```

### é”™è¯¯2ï¼šaddress already in use port 8000

**è§£å†³**ï¼š
```bash
# æŸ¥çœ‹å ç”¨8000ç«¯å£çš„è¿›ç¨‹
lsof -i :8000

# æ€æ­»å®ƒ
kill -9 <PID>

# æˆ–æ”¹ç”¨å…¶ä»–ç«¯å£
python -m uvicorn app.main:app --reload --port 8002
```

### é”™è¯¯3ï¼šdatabase is locked

**è§£å†³**ï¼š
```bash
cd /Users/ck/Desktop/Project/trustagency/backend

# å¤‡ä»½å½“å‰æ•°æ®åº“
cp trustagency.db trustagency.db.backup

# åˆ é™¤æ•°æ®åº“ï¼ˆä¼šè‡ªåŠ¨é‡å»ºï¼‰
rm trustagency.db

# é‡å¯åç«¯
python -m uvicorn app.main:app --reload --port 8000
```

---

## âœ… å¦‚æœåç«¯æˆåŠŸå¯åŠ¨äº†

### éªŒè¯1ï¼šæ£€æŸ¥æ•°æ®åº“åˆå§‹åŒ–
```bash
curl http://localhost:8000/api/init
# åº”è¯¥è¿”å›: {"status":"success","message":"Database initialized"}
```

### éªŒè¯2ï¼šæ£€æŸ¥åˆ†ç±»æ•°æ®
```bash
# è·å–token
TOKEN=$(curl -s -X POST http://localhost:8000/api/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}' \
  | python3 -c "import sys, json; print(json.load(sys.stdin).get('access_token', ''))")

# æ£€æŸ¥åˆ†ç±»
curl -s -H "Authorization: Bearer $TOKEN" \
  http://localhost:8000/api/categories | python3 -m json.tool | head -50
```

å¦‚æœè¿”å›çš„JSONæœ‰åˆ†ç±»æ•°æ®ï¼Œè¯´æ˜åˆ†ç±»å·²æ¢å¤ã€‚
å¦‚æœè¿”å›ç©ºæ•°ç»„ `[]`ï¼Œè¿è¡Œï¼š
```bash
python restore_categories.py
```

### éªŒè¯3ï¼šç™»å½•åå°
```
æ‰“å¼€æµè§ˆå™¨: http://localhost:8000/admin/
ç”¨æˆ·å: admin
å¯†ç : admin123
```

---

## ğŸ“‹ ä¸‰ä¸ªå·²çŸ¥çš„ä¿®å¤éªŒè¯

### ä¿®å¤1ï¼šHTTPæ–¹æ³•ï¼ˆPUTæ”¹ä¸ºPOSTï¼‰
```
ä½ç½®ï¼š/backend/site/admin/index.html ç¬¬2601è¡Œ
åº”è¯¥æ˜¯ï¼šconst method = currentPlatformId ? 'POST' : 'POST';
âœ“ å·²éªŒè¯ä»£ç ä¸­å­˜åœ¨
```

### ä¿®å¤2ï¼šcommission_rateéªŒè¯ï¼ˆ0-1èŒƒå›´ï¼‰
```
ä½ç½®ï¼š/backend/app/schemas/platform_admin.py ç¬¬31è¡Œ
åº”è¯¥æ˜¯ï¼šcommission_rate: Optional[float] = Field(None, ge=0.0, le=1.0, ...)
âœ“ å·²éªŒè¯ä»£ç ä¸­å­˜åœ¨
```

### ä¿®å¤3ï¼šè¡¨å•å­—æ®µæ¡ä»¶æ˜¾ç¤º
```
ä½ç½®ï¼š/backend/site/admin/index.html ç¬¬2360è¡Œ
åº”è¯¥æ˜¯ï¼šfunction renderDynamicPlatformForm(formDefinition, existingData = null) {
âœ“ å·²éªŒè¯ä»£ç ä¸­å­˜åœ¨
```

---

## ğŸ¯ 15ä¸ªBugçš„å¿«é€Ÿè§£å†³æ–¹æ¡ˆ

åœ¨åå°ç®¡ç†ç³»ç»Ÿä¸­é€ä¸ªæµ‹è¯•ï¼š

### oldbug001 âœ“ åˆ†ç±»ä¸¢å¤±
- [ ] æ‰“å¼€"æ ç›®ç®¡ç†"
- [ ] çœ‹æ¯ä¸ªæ ç›®ä¸‹æ˜¯å¦æœ‰5ä¸ªåˆ†ç±»
- [ ] å¦‚æœæ²¡æœ‰ï¼Œè¿è¡Œ `python restore_categories.py`

### bug009 âœ“ å†…å®¹æœªåŒæ­¥
- [ ] è¿™éœ€è¦ä»å‰ç«¯åŒæ­¥æ•°æ®åˆ°åç«¯
- [ ] æš‚æ—¶éœ€è¦æ‰‹åŠ¨å¡«å……æ•°æ®

### bug010 âœ“ Wikiæœç´¢ä¸èƒ½ç”¨
- [ ] æ£€æŸ¥å‰ç«¯æ˜¯å¦æœ‰æœç´¢åŠŸèƒ½ä»£ç 
- [ ] æ£€æŸ¥åç«¯æ˜¯å¦æœ‰æœç´¢API

### bug012 âœ“ AIä»»åŠ¡åˆ†ç±»æ— æ³•å¼¹å‡º
- [ ] æ‰“å¼€"AIä»»åŠ¡"
- [ ] é€‰æ‹©æ ç›®
- [ ] æ£€æŸ¥åˆ†ç±»ä¸‹æ‹‰æ¡†æ˜¯å¦æœ‰æ•°æ®
- [ ] å¦‚æœæ²¡æœ‰ï¼Œæ˜¯oldbug001çš„é—®é¢˜

### bug014 âœ“ æ–‡ç« é¢„è§ˆæŠ¥é”™
- [ ] åœ¨åå°ç‚¹å‡»"å‰å°é¢„è§ˆ"
- [ ] å¦‚æœæŠ¥é”™ï¼Œæ£€æŸ¥æµè§ˆå™¨console
- [ ] å¯èƒ½æ˜¯ article_view.html æ–‡ä»¶ç¼ºå¤±

---

## ğŸ’¾ åº”æ€¥æ–¹æ¡ˆï¼šå®Œå…¨é‡ç½®

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œæ‰§è¡Œå®Œå…¨é‡ç½®ï¼š

```bash
cd /Users/ck/Desktop/Project/trustagency/backend

# 1. å¤‡ä»½
cp trustagency.db trustagency.db.complete_backup

# 2. åˆ é™¤æ•°æ®åº“å’Œç¼“å­˜
rm trustagency.db
rm -rf __pycache__
find . -name "*.pyc" -delete

# 3. é‡æ–°åˆå§‹åŒ–
python init_db.py
python init_integration_data.py

# 4. æ¢å¤åˆ†ç±»
python restore_categories.py

# 5. å¯åŠ¨åç«¯
python -m uvicorn app.main:app --reload --port 8000
```

---

## ğŸ“ å¦‚æœè¿˜æ˜¯ä¸è¡Œ

è¯·å‘Šè¯‰æˆ‘ï¼š

1. ä½ åœ¨ç¬¬å‡ æ­¥å¡ä½äº†ï¼Ÿ
2. å…·ä½“çš„é”™è¯¯ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå¤åˆ¶æ•´æ®µé”™è¯¯ï¼‰
3. æµè§ˆå™¨consoleæœ‰é”™è¯¯å—ï¼Ÿ

è¿™æ ·æˆ‘èƒ½å¿«é€Ÿå®šä½é—®é¢˜ï¼

