# 平台字段条件显示 - 决策说明

## 📋 问题

"只有在验证栏目时才需要关联平台，但目前无法动态显示/隐藏"

---

## 🔍 分析结论

**为什么目前无法实现？**

1. **数据模型缺失** - 没有 `section` (栏目) 维度
   - 无法区分 "验证栏目" vs 其他栏目
   - 无法判断何时需要平台

2. **数据库约束** - `platform_id` 设为 NOT NULL
   - 所有文章必须关联平台
   - 无法存储无平台文章

3. **后端无条件逻辑** - API 总是要求 platform_id
   - 即使前端不发送，后端也会验证失败

4. **前端无栏目字段** - 没有栏目选择
   - 无法获知用户选了哪个栏目
   - 无法动态改变平台字段的显示/隐藏

---

## 💡 解决方案对比

### 方案 A: 前端硬编码 (1-2 小时) ⚡

**做法**: 在前端添加栏目选择，JavaScript 判断显示/隐藏

**优点**: 
- ✅ 快速实现
- ✅ 前端改动最小

**缺点**: 
- ❌ 数据不一致（栏目定义在前端）
- ❌ **无法真正保存无平台文章**（后端仍拒绝）
- ❌ 技术债务太多

**结论**: 不推荐 👎

---

### 方案 B: 前后端 + 数据库改造 (4-6 小时) ⭐ **推荐**

**做法**: 
1. 创建 `sections` 表 (栏目)
2. 改造 `articles` 表 (新增 section_id, 改造 platform_id)
3. 改造后端 API (添加条件逻辑)
4. 改造前端表单 (栏目选择 + 联动逻辑)

**优点**:
- ✅ 前后端一致
- ✅ 可以真正保存无平台文章
- ✅ 为后续完整重构准备基础
- ✅ 短期内完成 (4-6h)

**缺点**:
- ❌ 需要修改数据库
- ❌ 有一定的实现复杂度

**结论**: 推荐 👍

---

### 方案 C: 完整重构 (12-16 小时)

**做法**: 完整的栏目→分类→文章三层结构，AI 任务系统重构  
(这就是 `SECTION_CATEGORY_REFACTOR_PLAN.md` 中的 A-15)

**优点**:
- ✅ 完全解决问题
- ✅ 架构最清晰
- ✅ 扩展性最好

**缺点**:
- ❌ 工作量最大
- ❌ 涉及面最广
- ❌ 需要充分测试

**结论**: 后续作为长期规划 📅

---

## 🎯 建议决策

### 最优路径:

**今天**: 
- ✅ 推进 **方案 B** (4-6 小时)
- ✅ 快速实现平台条件显示/隐藏
- ✅ 为后续完整重构打基础

**后续 (1-2 周后)**:
- 📅 推进 **方案 C** (A-15 完整重构)
- 📅 基于方案 B 的基础继续
- 📅 添加分类系统、AI 任务重构

### 如果暂时搁置:
- 保持现状：平台字段总是显示、总是必填
- 记录在案，后续激活时按方案 B 推进

---

## 📊 工作量估算

### 方案 B 详细分解 (4-6 小时):

| 任务 | 时间 | 难度 |
|------|------|------|
| 创建 sections 表 | 0.5h | ⭐ |
| 改造 articles 表 | 0.5h | ⭐ |
| 改造后端 Schema | 1h | ⭐⭐ |
| 改造后端 Route | 1h | ⭐⭐ |
| 改造前端 HTML | 0.5h | ⭐ |
| 实现 JS 联动逻辑 | 1-1.5h | ⭐⭐ |
| 测试验证 | 1h | ⭐ |

**合计**: 5-6 小时

---

## 📝 详细分析文档

完整的技术分析见: 

📄 **`PLATFORM_CONDITIONAL_DISPLAY_ANALYSIS.md`**

包含:
- 根本原因分析 (4 大障碍)
- 三个方案的详细对比
- 技术栈变更清单
- 决策表

---

## ✅ 下一步行动

请选择:

**选项 1**: 👍 立即推进方案 B
- 预计今天完成
- 快速解决平台条件显示问题

**选项 2**: 📅 暂时搁置
- 保持现状
- 后续作为完整重构的一部分

**选项 3**: 🚀 直接做方案 C (完整重构)
- 一次性解决所有问题
- 需要 12-16 小时

---

等待您的决策反馈！

