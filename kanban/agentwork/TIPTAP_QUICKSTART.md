# 🚀 Tiptap编辑器 - 快速启动指南

## ✨ 3个步骤启动编辑器

### 步骤1️⃣: 启动后端服务

```bash
cd /Users/ck/Desktop/Project/trustagency/backend

# 启动服务 (选择一种)
python run_backend.sh
# 或
uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```

✅ 看到 "Uvicorn running on http://0.0.0.0:8001" 表示成功

### 步骤2️⃣: 打开后台系统

浏览器访问: **http://localhost:8001/admin**

### 步骤3️⃣: 登录并测试编辑器

| 字段 | 值 |
|------|-----|
| 用户名 | `admin` |
| 密码 | `newpassword123` |

---

## 📝 测试编辑器 (2分钟)

1. **打开编辑界面**
   - 点击左侧菜单 "文章管理"
   - 点击 "+ 新增文章" 按钮

2. **填入基本信息**
   - 标题: "测试文章 - Tiptap编辑器"
   - 栏目: 选择任意栏目
   - 分类: "测试"

3. **测试编辑功能** (点击工具栏按钮)
   - **B** → 输入文本 → 成功变粗体
   - **I** → 输入文本 → 成功变斜体
   - **H2** → 生成标题
   - **• 列表** → 生成bullet列表
   - **图片** → 选择上传本地图片 → 成功插入

4. **保存文章**
   - 点击底部 "保存" 按钮
   - 看到 "保存成功" 提示

5. **验证保存**
   - 返回文章列表
   - 刷新页面
   - 再次编辑该文章
   - 编辑器自动加载保存的内容

✅ 所有测试通过 = 编辑器完全可用

---

## 📊 功能一览

| 功能 | 按钮 | 说明 |
|------|------|------|
| **粗体** | B | 快捷键: Ctrl+B |
| **斜体** | I | 快捷键: Ctrl+I |
| **删除线** | S | 中划线效果 |
| **代码** | Code | 行内代码 |
| **无序列表** | • 列表 | Bullet list |
| **有序列表** | 1. 列表 | Numbered list |
| **标题1** | H1 | 最大标题 |
| **标题2** | H2 | 中等标题 |
| **标题3** | H3 | 小标题 |
| **引用** | 引用 | Blockquote |
| **代码块** | 代码块 | `<pre><code>` |
| **图片** | 图片 | 上传或URL |
| **链接** | 链接 | 超链接 |
| **撤销** | ↶ 撤销 | 恢复上一步 |
| **重做** | ↷ 重做 | 恢复下一步 |

---

## 📸 图片上传详解

### 方式1: 上传本地文件 ✅ 推荐

```
点击"图片" → 选择"1 = 上传本地文件"
    ↓
选择你的图片文件 (jpg, png, gif等)
    ↓
自动上传到服务器
    ↓
图片自动插入编辑器
    ↓
保存文章时图片URL一起保存
```

**支持格式**: jpg, png, gif, webp, bmp, svg  
**最大大小**: 5MB  
**存储位置**: `/backend/static/uploads/images/`

### 方式2: 输入图片URL

```
点击"图片" → 选择"2 = 输入图片URL"
    ↓
输入任何图片URL
    ↓
图片插入编辑器
```

**用途**: 引用外部图片、CDN图片等

---

## 🔧 常见操作

### 创建新文章 (含富文本)

1. 文章管理 → + 新增文章
2. 输入标题、栏目、分类
3. **在编辑器中输入内容**
   - 使用工具栏格式化
   - 可混合多种格式
   - 支持嵌套列表、引用等
4. 点击"保存"

### 编辑已有文章

1. 文章管理 → 表格中找到文章
2. 点击 "编辑" 按钮
3. **编辑器自动加载文章内容** ✨
4. 修改内容
5. 点击"保存"

### 创建包含图片的文章

1. 点击"图片"按钮
2. 选择上传本地文件
3. 等待上传完成
4. **图片自动插入** ✨
5. 继续编辑其他内容
6. 保存文章

---

## ✅ 验证清单

测试前检查以下项目:

- [ ] 后端服务启动成功 (端口8001)
- [ ] 浏览器能访问 http://localhost:8001/admin
- [ ] 能用 admin/newpassword123 登录
- [ ] "文章管理"菜单可见
- [ ] "+ 新增文章"按钮可用
- [ ] 编辑器工具栏显示15个按钮
- [ ] 编辑器容器有灰色工具栏和白色编辑区

---

## 🐛 遇到问题？

### 编辑器不显示

**问题**: 打开文章编辑界面，没看到编辑器，只有空白

**解决**:
1. 打开浏览器控制台 (F12)
2. 查看 Console 标签页
3. 如果有红色错误信息，复制错误内容
4. 检查网络连接，确保CDN库加载成功

**降级方案**: 如果CDN库加载失败，会自动显示 textarea (基础文本框)

### 图片上传失败

**问题**: 点击图片按钮上传，显示错误

**排查步骤**:
1. 检查文件类型 (必须是图片)
2. 检查文件大小 (不能超过5MB)
3. 检查认证 (是否正常登录)
4. 查看浏览器控制台错误信息

### 内容保存失败

**问题**: 点击保存，一直不响应或显示错误

**排查步骤**:
1. 检查必填字段 (标题、栏目、分类)
2. 检查是否选择了栏目
3. 检查网络连接
4. 查看浏览器控制台错误

### 编辑器卡顿

**问题**: 打字或格式化很慢

**解决**:
1. 检查浏览器标签页数量 (关闭不用的)
2. 清理浏览器缓存
3. 更新浏览器到最新版本
4. 尝试在隐私/无痕模式下测试

---

## 📚 文档导航

- **完整实施报告**: `TIPTAP_IMPLEMENTATION_REPORT.md`
- **评估与方案**: `MARKDOWN_EDITOR_EVALUATION.md`
- **实施指南**: `TIPTAP_IMPLEMENTATION_GUIDE.md`
- **HTML代码**: `/backend/site/admin/index.html` (3000+ 行)
- **后端API**: `/backend/app/routes/upload.py`
- **主应用**: `/backend/app/main.py`

---

## 🎉 测试成功标志

当你看到以下现象，说明编辑器完全正常工作:

✅ 工具栏15个按钮全部显示  
✅ 能在编辑区输入文本  
✅ 点击B按钮，文本变粗体  
✅ 点击列表按钮，生成列表  
✅ 点击H2按钮，生成标题  
✅ 能上传图片并显示  
✅ 能输入链接URL并插入  
✅ 撤销/重做正常工作  
✅ 保存后内容持久化  
✅ 编辑已有文章时内容正确加载  

---

## 🚀 下一步

### 立即可做
- ✅ 测试基础编辑功能
- ✅ 测试图片上传
- ✅ 创建包含富文本的文章

### 这周可做
- 🔲 添加Markdown导入/导出
- 🔲 添加表格支持
- 🔲 优化移动端体验

### 后期优化
- 🔲 实时协作编辑
- 🔲 AI内容助手
- 🔲 内容版本历史

---

## 💡 小贴士

### 快速格式化

1. **粗体**: 选中文本 → 点击B (或 Ctrl+B)
2. **列表**: 点击列表按钮 → 自动添加符号
3. **标题**: 点击H2 → 当前段落变标题
4. **撤销**: 组合键 Ctrl+Z 或 点击↶按钮

### 最佳实践

1. **先写后格式化** - 先完成内容，再美化格式
2. **使用标题结构** - H2用于章节，H3用于小标题
3. **图片放关键位置** - 让读者快速了解内容
4. **定期保存** - 每完成一段就点保存

### 键盘快捷键

这些是标准快捷键，应该都能用:
- `Ctrl+B` = 粗体
- `Ctrl+I` = 斜体
- `Ctrl+Z` = 撤销
- `Ctrl+Shift+Z` = 重做
- `Ctrl+K` = 链接 (在部分编辑器)

---

## 📞 获取帮助

1. **查看浏览器控制台** (F12 → Console)
2. **检查网络请求** (F12 → Network)
3. **阅读完整文档** (参考上面的文档导航)
4. **查看后端日志** (服务器启动的终端窗口)

---

**祝你编辑愉快! 🎉**

有任何问题或反馈，欢迎提出改进建议。

